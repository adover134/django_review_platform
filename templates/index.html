{% load static %}

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Rolling Stone Top 500 albums of all time</title>
  <meta name="description" content="Rolling Stone magazine's 2012 list of 500 greatest albums of all time with genres.">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.css">
  <link rel="stylesheet" href="//cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="{% static 'RowGroup-1.2.0/css/rowGroup.dataTables.css' %}">
  <link rel="stylesheet" href="{% static 'RowGroup-1.2.0/css/rowGroup.bootstrap5.css' %}">
</head>

<body>
  <div class="row">
    <div class="col-sm-12">
      <table id="albums_by_decade" class="table table-striped table-bordered" style="width:100%">
        <thead>
          <tr style="display:none;">
            <th></th>
            <th>리뷰 제목</th>
            <th>작성자</th>
            <th>이메일</th>
            <th>이미지</th>
          </tr>
        </thead>
      </table>
    </div>
  </div>
  <script type="text/javascript" src="https://cdn.datatables.net/v/ju/jq-3.6.0/dt-1.12.1/r-2.3.0/rg-1.2.0/datatables.min.js"></script>
  <script>
      let imageUrl = "/static/images/";
      $(document).ready(function() {
        var table = $('#review').DataTable(
        {
          "serverSide": true,
          "ajax": "/db/review/?format=datatables",
          createdRow: function (row, data, dataIndex) {
            console.log(data);
            {
              // Add COLSPAN attribute
              $('td:eq(1)', row).attr('rowspan', 1);
              $('td:eq(1)', row).attr('align', 'center');

              // Center horizontally
              $('td:eq(1)', row).attr('align', 'center');

              // Hide required number of columns
              // next to the cell with COLSPAN attribute
              //$('td:eq(2)', row).css('display', 'none');
              //$('td:eq(3)', row).css('display', 'none');

              // Update cell data
              //this.api().cell($('td:eq(1)', row)).data('N/A');
            }
          },
          "columns": [
            {"data": "id", "visible": false},
            {"data": "reviewTitle"},
            {"data": "reviewWriter"},
            {"data": "uEmail"},
            {"data": "representiveImage"},
            // Use dot notation to reference nested serializers.
            // This data: could alternatively be displayed with the serializer's ReadOnlyField as well, as seen in the minimal example.
          ],
          "columnDefs": [
            {
              "targets": 0,
              "visible": false,
            },
            {
              "targets": 1,
              "data": "reviewTitle",
              "render": function (data, type, row, meta) {
                return '<a href="http://127.0.0.1:8000/test/normal_user_review_read/?id=' + (row.id).toString() + '">' + data + '</a>';
              }
            },
            {
              "targets": 4,
              "data": "representiveImage",
              "render": function (data, type, row, meta) {
                if (data !== null)
                  return '<img src="' + imageUrl + data + '" style="height: 12vh; width :6.8vw;">';
                else
                  return '';
              }
            }
          ],
        });
      });
  </script>
</body>
</html>