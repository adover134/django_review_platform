{% extends 'normal_user_review_list.html' %}
{% load index static %}
{% block info %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>
    <script type="text/javascript" src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <script type="text/javascript"
            src="//dapi.kakao.com/v2/maps/sdk.js?appkey={{ javakey|java_key }}&libraries=services&autoload=true"></script>
<div id="reviewHead" style = "height:32.8%; ">
    <div style ="margin:15px; height:100%">
        <div style="width:24.7%; height:90.7%; margin-right:20px; display: inline-block;float:left;">
                <img src="{% static 'images/' %}no-photo.png" style="width:100%; height:100%;">
        </div>
        <div id="mapDiv" style = "display:inline-block;"></div>
        <script type="text/javascript" src="{% static 'js/normalUserReviewReadTemplate.js' %}"></script>
        <script>
            $(document).ready(function () {
                var a = $('.slider').bxSlider({
                    {#maxSlides:4,#}
                    infiniteLoop: false,
                    touchEnabled: false,
                });
            });
        </script>
        <script type="text/javascript">

        // icon 이미지 <-> selected icon 이미지 변환 함수
        // 만들 예정
        function selectIcon2(e){
            alert("아이콘 클릭 이벤트 발생")
        }

            document.getElementById('mapDiv').style.width = '71%';
            document.getElementById('mapDiv').style.height = '90.7%';
            document.getElementById('mapDiv').style.minWidth = '71%';
            var mapContainer = document.getElementById('mapDiv'), // 지도를 표시할 div
                mapOption = {
                    center: new kakao.maps.LatLng(36.628064331494166, 127.45600280223212), // 지도의 중심좌표
                    level: 5 // 지도의 확대 레벨
                };

            // 지도 생성
            function resizeMap() {
                var mapContainer = document.getElementById('map');
                mapContainer.style.width = document.getElementById('mainDiv').style.width;
            }

            var map = new kakao.maps.Map(mapContainer, mapOption);

            {# 지도에 원룸 위치 표시 #}
            var geocoder = new kakao.maps.services.Geocoder();

            $.ajax({
                url: 'http://127.0.0.1:8000/db/room/',
                method: "GET",
                dataType: "json"
            })
                .done(function (json) {
                    $.each(json, function (key, value) {
                        // 주소로 좌표를 검색합니다
                        geocoder.addressSearch(value.address, function (result, status) {

                            // 정상적으로 검색이 완료됐으면
                            if (status === kakao.maps.services.Status.OK) {
                                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                                // 결과값으로 받은 위치를 마커로 표시합니다
                                var marker = new kakao.maps.Marker({
                                    map: map,
                                    position: coords
                                });

                                var room_info = ''
                                if (value.name !== null)
                                    room_info = value.name
                                else
                                    room_info = value.address

                                // 인포윈도우로 장소에 대한 설명을 표시합니다
                                var infowindow = new kakao.maps.InfoWindow({
                                    content: '<div style="width:150px;text-align:center;padding:6px 0;">' + room_info + '</div>'
                                });

                                infowindow.open(map, marker);
                            }
                        })
                    })
                });
        </script>
    </div>
</div>
<div id="review_table">

    <div id="row1">
        <div id="writer">

        </div>
        <div style="height:100%; width:8.1%;"></div>
        <div id="address">

        </div>
        <div id="room_read">

        </div>
    </div>
    <div id="row2">
        <div id="title">

        </div>
    </div>
    <div id="row3">
        <div style="width:14.82%; border-right:2px solid #B3B3B3;"><div style="display: flex;width: 100%;height: 100%;align-items: center;">월세</div></div>
        <div style="width:13.834%; border-right:2px solid #B3B3B3;"><div style="display: flex;width: 100%;height: 100%;align-items: center;">크기</div></div>
        <div style="width:12.846%; border-right:2px solid #B3B3B3;"><div style="display: flex;width: 100%;height: 100%;align-items: center;">채광</div></div>
        <div style="width:12.846%; border-right:2px solid #B3B3B3;"><div style="display: flex;width: 100%;height: 100%;align-items: center;">청결</div></div>
        <div style="width:12.846%; border-right:2px solid #B3B3B3;"><div style="display: flex;width: 100%;height: 100%;align-items: center;">온도</div></div>
        <div style="width:12.846%; border-right:2px solid #B3B3B3;"><div style="display: flex;width: 100%;height: 100%;align-items: center;">습도</div></div>
        <div style="width:19.962%; height:100%;"></div>
    </div>
    <div id="row4">

    </div>
    <div id="row5">
        <div id="icons">

        </div>
        <div id="rec_rep">
            <div id="rec_icon">

            </div>
            <div id="rec_button">
                추천
            </div>
            <div id="rep_icon">

            </div>
            <div id="rep_button">
                신고
            </div>
        </div>
    </div>
</div>
<link rel="stylesheet" href="{% static 'css/normalUserReviewReadTemplate.css' %}">
<script>
    window.onload = function()
    {
        let a = Array.from(document.getElementById('row3').children);
        console.log(a[0].offsetHeight);
        a.forEach(function (o) {
            let b = o.offsetHeight / 16;
            let c = o.offsetWidth - o.offsetHeight;
            let d = o.innerText;
            c = (c / d.length) / 16;
            console.log(o);
            if (b > c)
                o.style.fontSize = c.toString() + 'rem';
            else
                o.style.fontSize = b.toString() + 'rem';
        });
        a=document.getElementById('rec_button');
        b=(a.offsetHeight/16).toString()+'rem';
        a.style.fontSize=b;
        a=document.getElementById('rep_button');
        b=(a.offsetHeight/16).toString()+'rem';
        a.style.fontSize=b;
    }
</script>
<br>
{% endblock %}